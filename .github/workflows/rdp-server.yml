name: üöÄ SERVER AI STV PREMIUM

on:
  workflow_dispatch:
    inputs:
      duration:
        description: "üïê Usage Duration"
        required: false
        default: "5h40m"
        type: choice
        options:
          - "1h"
          - "3h"
          - "5h40m"

jobs:
  Premium-RDP-Setup:
    runs-on: windows-latest
    timeout-minutes: 340

    steps:
      # WELCOME BANNER
      - name: üéØ SYSTEM STARTUP
        run: |
          Write-Host ""
          Write-Host ""
          Write-Host "ü§ñ AI STV PREMIUM RDP SERVER" -ForegroundColor Yellow
          Write-Host "‚ö° Powered by AI STV" -ForegroundColor Green
          Write-Host "üïí Time: ${{ github.event.inputs.duration }}" -ForegroundColor Magenta
          Write-Host ""

          # Loading effect
          $frames = @('‚£æ', '‚£Ω', '‚£ª', '‚¢ø', '‚°ø', '‚£ü', '‚£Ø', '‚£∑')
          for($i=0; $i -lt 10; $i++) {
              Write-Host "`rüöÄ Initializing system... $($frames[$i % 8])" -NoNewline -ForegroundColor Blue
              Start-Sleep -Milliseconds 100
          }
          Write-Host "`r‚úÖ System is ready!                    " -ForegroundColor Green

      # ADVANCED CONFIGURATION
      - name: üîß SYSTEM CONFIGURATION
        run: |
          Write-Host ""
          Write-Host "üõ†Ô∏è  CONFIGURING SYSTEM" -ForegroundColor Yellow

          $steps = @(
              @{Name="Enable Remote Desktop"; Script={ 
                  Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -Name "fDenyTSConnections" -Value 0 -Force
              }},
              @{Name="Disable Network Authentication"; Script={
                  Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -Name "UserAuthentication" -Value 0 -Force
              }},
              @{Name="Configure RDP Security"; Script={
                  Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -Name "SecurityLayer" -Value 0 -Force
                  Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -Name "UserAuthentication" -Value 0 -Force
              }},
              @{Name="Open Firewall Port 3389"; Script={
                  netsh advfirewall firewall add rule name="RDP-Premium" dir=in action=allow protocol=TCP localport=3389 profile=any
                  netsh advfirewall firewall add rule name="RDP-Premium-Out" dir=out action=allow protocol=TCP localport=3389 profile=any
              }},
              @{Name="Start Services"; Script={
                  Set-Service -Name TermService -StartupType Automatic -ErrorAction SilentlyContinue
                  Set-Service -Name UmRdpService -StartupType Automatic -ErrorAction SilentlyContinue
                  Start-Service -Name TermService -ErrorAction SilentlyContinue
                  Start-Service -Name UmRdpService -ErrorAction SilentlyContinue
              }}
          )

          foreach($step in $steps) {
              Write-Host "‚îÇ üìã $($step.Name)..." -NoNewline -ForegroundColor White
              try {
                  & $step.Script
                  Write-Host "`r‚îÇ ‚úÖ $($step.Name)" -ForegroundColor Green
              } catch {
                  Write-Host "`r‚îÇ ‚ö†Ô∏è  $($step.Name) - Minor error ignored" -ForegroundColor Yellow
              }
              Start-Sleep -Milliseconds 500
          }

          Write-Host "üéØ Configuration complete!" -ForegroundColor Green

      # CREATE USER PREMIUM
      - name: üë§ CREATE PREMIUM ACCOUNT
        run: |
          Write-Host ""
          Write-Host "üë§ CREATING PREMIUM ACCOUNT" -ForegroundColor Yellow

          # Function to generate short password (8 chars)
          function New-PremiumPassword {
              param()
              $upper = 'ABCDEFGHJKLMNPQRSTUVWXYZ'
              $lower = 'abcdefghijkmnpqrstuvwxyz'
              $numbers = '23456789'
              $all = $upper + $lower + $numbers

              $pw = ''
              $pw += $upper[(Get-Random -Minimum 0 -Maximum $upper.Length)]
              $pw += $lower[(Get-Random -Minimum 0 -Maximum $lower.Length)]
              $pw += $numbers[(Get-Random -Minimum 0 -Maximum $numbers.Length)]

              for ($i = 1; $i -le 5; $i++) {
                  $pw += $all[(Get-Random -Minimum 0 -Maximum $all.Length)]
              }

              return -join ($pw.ToCharArray() | Sort-Object { Get-Random })
          }

          if ($env:CUSTOM_RDP_PASS) {
              $matKhau = $env:CUSTOM_RDP_PASS
              Write-Host "‚îÇ ‚ÑπÔ∏è  Using custom password" -ForegroundColor Blue
          } else {
              $matKhau = New-PremiumPassword
          }

          $securePass = ConvertTo-SecureString $matKhau -AsPlainText -Force

          try {
              Remove-LocalUser -Name "AISTV-PREMIUM" -ErrorAction SilentlyContinue
              Write-Host "‚îÇ ‚úÖ Old user removed" -ForegroundColor Green
          } catch {
              Write-Host "‚îÇ ‚ÑπÔ∏è  No old user found" -ForegroundColor Blue
          }

          try {
              New-LocalUser -Name "AISTV-PREMIUM" -Password $securePass -AccountNeverExpires -Description "AI STV Premium Account"
              Write-Host "‚îÇ ‚úÖ New user created" -ForegroundColor Green
              
              try {
                  Set-LocalUser -Name "AISTV-PREMIUM" -PasswordNeverExpires $true -ErrorAction SilentlyContinue
              } catch {}

              Add-LocalGroupMember -Group "Administrators" -Member "AISTV-PREMIUM" -ErrorAction SilentlyContinue
              Add-LocalGroupMember -Group "Remote Desktop Users" -Member "AISTV-PREMIUM" -ErrorAction SilentlyContinue
              Add-LocalGroupMember -Group "Users" -Member "AISTV-PREMIUM" -ErrorAction SilentlyContinue
              
              Enable-LocalUser -Name "AISTV-PREMIUM"
              
              Write-Host "‚îÇ ‚úÖ Granted Administrator & RDP privileges" -ForegroundColor Green
              
          } catch {
              Write-Host "‚îÇ ‚ùå Error creating user: $($_.Exception.Message)" -ForegroundColor Red
              exit 1
          }

          echo "RDP_USER=AISTV-PREMIUM" >> $env:GITHUB_ENV
          echo "RDP_PASS=$matKhau" >> $env:GITHUB_ENV
          echo "$matKhau" > $env:TEMP\rdp_password.txt

          Write-Host "‚úÖ Account: AISTV-PREMIUM is ready" -ForegroundColor Green

      # CHECK PERMISSIONS
      - name: üîç CHECK SYSTEM PERMISSIONS
        run: |
          Write-Host ""
          Write-Host "üîç CHECKING LOGIN PERMISSIONS" -ForegroundColor Yellow

          $user = Get-LocalUser -Name "AISTV-PREMIUM" -ErrorAction SilentlyContinue
          if ($user) {
              Write-Host "‚îÇ ‚úÖ User AISTV-PREMIUM exists" -ForegroundColor Green
              Write-Host "‚îÇ üìä Status: $($user.Enabled)" -ForegroundColor White
          } else {
              Write-Host "‚îÇ ‚ùå User does not exist" -ForegroundColor Red
              exit 1
          }

          $isAdmin = (Get-LocalGroupMember -Group "Administrators" | Where-Object {$_.Name -like "*AISTV-PREMIUM"}).Count -gt 0
          if ($isAdmin) {
              Write-Host "‚îÇ ‚úÖ Has Administrator privileges" -ForegroundColor Green
          } else {
              Write-Host "‚îÇ ‚ùå No Administrator privileges" -ForegroundColor Red
          }

          $isRDPUser = (Get-LocalGroupMember -Group "Remote Desktop Users" | Where-Object {$_.Name -like "*AISTV-PREMIUM"}).Count -gt 0
          if ($isRDPUser) {
              Write-Host "‚îÇ ‚úÖ Has Remote Desktop privileges" -ForegroundColor Green
          } else {
              Write-Host "‚îÇ ‚ùå No Remote Desktop privileges" -ForegroundColor Red
          }

          $termService = Get-Service -Name TermService -ErrorAction SilentlyContinue
          if ($termService.Status -eq 'Running') {
              Write-Host "‚îÇ ‚úÖ TermService is running" -ForegroundColor Green
          } else {
              Write-Host "‚îÇ ‚ùå TermService is not running" -ForegroundColor Red
          }

          Write-Host "üéØ Check complete!" -ForegroundColor Green

      # TAILSCALE PREMIUM
      - name: üåê PREMIUM NETWORK SETUP
        env:
          TAILSCALE_AUTH_KEY: ${{ secrets.TAILSCALE_AUTH_KEY }}
        run: |
          Write-Host ""
          Write-Host "üåê SETTING UP NETWORK CONNECTION" -ForegroundColor Yellow

          Write-Host "‚îÇ üì¶ Installing Tailscale via Chocolatey..." -ForegroundColor Yellow
          choco install tailscale -y --no-progress --limit-output

          if ($LASTEXITCODE -ne 0) {
              Write-Host "‚îÇ ‚ùå Tailscale installation error" -ForegroundColor Red
              throw "Failed to install Tailscale via Chocolatey"
          }

          Write-Host "‚îÇ ‚úÖ Tailscale installed successfully!" -ForegroundColor Green

          # Refresh environment PATH
          $env:Path = [System.Environment]::GetEnvironmentVariable("Path","Machine") + ";" + [System.Environment]::GetEnvironmentVariable("Path","User")
          echo "TAILSCALE_INSTALLED=true" >> $env:GITHUB_ENV

          Write-Host "‚îÇ üîó Connecting to Tailscale network..." -ForegroundColor Yellow
          tailscale up --authkey=$env:TAILSCALE_AUTH_KEY --hostname=ai-stv-premium-$env:GITHUB_RUN_ID --accept-routes --accept-dns --reset

          Start-Sleep -Seconds 5

          Write-Host "‚îÇ üîÑ Fetching IP address..." -ForegroundColor Blue
          $ip = $null
          for($i=0; $i -lt 20; $i++) {
              $ip = tailscale ip -4 2>&1
              if ($ip -and $ip -match '^\d+\.\d+\.\d+\.\d+$') {
                  Write-Host "‚îÇ ‚úÖ IP Address: $ip" -ForegroundColor Green
                  echo "TAILSCALE_IP=$ip" >> $env:GITHUB_ENV
                  break
              }
              Write-Host "‚îÇ ‚è≥ Waiting for IP address... ($i/20)" -ForegroundColor Cyan
              Start-Sleep -Seconds 3
          }

          if (-not $ip -or $ip -notmatch '^\d+\.\d+\.\d+\.\d+$') {
              Write-Host "‚îÇ ‚ùå Failed to get IP after 60 seconds" -ForegroundColor Red
              throw "Failed to get Tailscale IP address"
          }

          Write-Host "üéØ Network setup complete!" -ForegroundColor Green

      # DISPLAY INFO
      - name: üéâ CONNECTION INFORMATION
        run: |
          $matKhau = Get-Content $env:TEMP\rdp_password.txt -ErrorAction SilentlyContinue
          if (-not $matKhau) {
              $matKhau = "Cannot read password"
          }

          $durationInput = "${{ github.event.inputs.duration }}"
          switch ($durationInput) {
              "1h" { $totalMinutes = 60; $displayTime = "1 hour" }
              "3h" { $totalMinutes = 180; $displayTime = "3 hours" }
              "5h40m" { $totalMinutes = 340; $displayTime = "5 hours 40 minutes" }
          }

          $timeZone = [System.TimeZoneInfo]::FindSystemTimeZoneById("SE Asia Standard Time")
          $thoiGianBatDau = [System.TimeZoneInfo]::ConvertTimeFromUtc((Get-Date).ToUniversalTime(), $timeZone)
          $thoiGianKetThuc = $thoiGianBatDau.AddMinutes($totalMinutes)

          Write-Host ""
          Write-Host "‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê" -ForegroundColor Cyan
          Write-Host "‚îÇ         üéâ CONNECTION SUCCESSFUL!         ‚îÇ" -ForegroundColor Cyan
          Write-Host "‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§" -ForegroundColor Cyan
          Write-Host "‚îÇ üåê  Address: $env:TAILSCALE_IP" -ForegroundColor White
          Write-Host "‚îÇ üë§  Username: AISTV-PREMIUM" -ForegroundColor White
          Write-Host "‚îÇ üîê  Password: $matKhau" -ForegroundColor White
          Write-Host "‚îÇ ‚è∞  Duration: $displayTime" -ForegroundColor White
          Write-Host "‚îÇ üïê  Start: $($thoiGianBatDau.ToString('HH:mm:ss'))" -ForegroundColor White
          Write-Host "‚îÇ üïê  End: $($thoiGianKetThuc.ToString('HH:mm:ss'))" -ForegroundColor White
          Write-Host "‚îÇ üìç  Port: 3389" -ForegroundColor White
          Write-Host "‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§" -ForegroundColor Cyan
          Write-Host "‚îÇ üí°  Instructions:                         ‚îÇ" -ForegroundColor Cyan
          Write-Host "‚îÇ   1. Open 'Remote Desktop Connection'     ‚îÇ" -ForegroundColor Yellow
          Write-Host "‚îÇ   2. Enter IP: $env:TAILSCALE_IP          ‚îÇ" -ForegroundColor Yellow
          Write-Host "‚îÇ   3. Enter User: AISTV-PREMIUM & Pass     ‚îÇ" -ForegroundColor Yellow
          Write-Host "‚îÇ   4. Enjoy! üöÄ                            ‚îÇ" -ForegroundColor Yellow
          Write-Host "‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò" -ForegroundColor Cyan

          echo "TOTAL_MINUTES=$totalMinutes" >> $env:GITHUB_ENV
          echo "REPO_NAME=${{ github.repository }}" >> $env:GITHUB_ENV

      # AUTO SEND INFO
      - name: üì° AUTOMATIC INFO UPDATE
        env:
          SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
          SUPABASE_ANON_KEY: ${{ secrets.SUPABASE_ANON_KEY }}
        run: |
          Write-Host ""
          Write-Host "üì° SENDING INFO AUTOMATICALLY..." -ForegroundColor Yellow

          $matKhau = Get-Content $env:TEMP\rdp_password.txt -ErrorAction SilentlyContinue
          $repoName = "${{ github.event.repository.name }}"

          $body = @{
              repoName = $repoName
              tailscaleIp = $env:TAILSCALE_IP
              rdpUser = "AISTV-PREMIUM"
              rdpPassword = $matKhau
          } | ConvertTo-Json

          try {
              $response = Invoke-RestMethod -Method POST `
                  -Uri "$env:SUPABASE_URL/functions/v1/update-rdp-info" `
                  -Headers @{
                      "Content-Type" = "application/json"
                      "apikey" = $env:SUPABASE_ANON_KEY
                      "Authorization" = "Bearer $env:SUPABASE_ANON_KEY"
                  } `
                  -Body $body `
                  -TimeoutSec 30
              
              Write-Host "‚îÇ ‚úÖ Info sent automatically!" -ForegroundColor Green
              Write-Host "‚îÇ üìä Response: $($response.message)" -ForegroundColor Blue
          } catch {
              Write-Host "‚îÇ ‚ö†Ô∏è  Could not send automatically (does not affect RDP)" -ForegroundColor Yellow
              Write-Host "‚îÇ üìù Reason: $($_.Exception.Message)" -ForegroundColor Gray
          }

          Write-Host "üéØ Complete!" -ForegroundColor Green

      # KEEP ALIVE
      - name: ‚è≥ MAINTAIN SESSION
        run: |
          $matKhau = Get-Content $env:TEMP\rdp_password.txt -ErrorAction SilentlyContinue
          $totalMinutes = $env:TOTAL_MINUTES

          $timeZone = [System.TimeZoneInfo]::FindSystemTimeZoneById("SE Asia Standard Time")
          $thoiGianBatDau = [System.TimeZoneInfo]::ConvertTimeFromUtc((Get-Date).ToUniversalTime(), $timeZone)
          $thoiGianKetThuc = $thoiGianBatDau.AddMinutes($totalMinutes)

          Write-Host ""
          Write-Host "üîÑ STARTING SESSION MAINTENANCE..." -ForegroundColor Yellow
          Write-Host "üíé Session: AI STV PREMIUM" -ForegroundColor Magenta
          Write-Host "üîó Connection: $env:TAILSCALE_IP" -ForegroundColor Cyan
          Write-Host "üïê Start: $($thoiGianBatDau.ToString('HH:mm:ss'))" -ForegroundColor Green
          Write-Host "üïê End: $($thoiGianKetThuc.ToString('HH:mm:ss'))" -ForegroundColor Green
          Write-Host ""

          $monitorScript = {
              $lastLogTime = Get-Date
              while ($true) {
                  $currentTime = Get-Date
                  
                  if (($currentTime - $lastLogTime).TotalMinutes -ge 2) {
                      $termService = Get-Service -Name TermService -ErrorAction SilentlyContinue
                      $rdpConnections = Get-NetTCPConnection -LocalPort 3389 -ErrorAction SilentlyContinue | Where-Object {$_.State -eq 'Established'}
                      
                      Write-Host "[$($currentTime.ToString('HH:mm:ss'))] üìä Status - RDP: $($termService.Status), Connections: $($rdpConnections.Count)" -ForegroundColor Blue
                      $lastLogTime = $currentTime
                  }
                  
                  $termService = Get-Service -Name TermService -ErrorAction SilentlyContinue
                  if ($termService.Status -ne 'Running') {
                      Write-Host "[$($currentTime.ToString('HH:mm:ss'))] üîÑ Restarting TermService..." -ForegroundColor Yellow
                      Start-Service -Name TermService -ErrorAction SilentlyContinue
                  }
                  
                  Start-Sleep -Seconds 30
              }
          }

          Start-Job -ScriptBlock $monitorScript -Name "SystemMonitor"

          $frames = @('‚†ã', '‚†ô', '‚†π', '‚†∏', '‚†º', '‚†¥', '‚†¶', '‚†ß', '‚†á', '‚†è')
          $colors = @('Red', 'Yellow', 'Green', 'Cyan', 'Blue', 'Magenta')
          $startTime = Get-Date

          do {
              $thoiGianHienTai = [System.TimeZoneInfo]::ConvertTimeFromUtc((Get-Date).ToUniversalTime(), $timeZone)
              $thoiGianConLai = $thoiGianKetThuc - $thoiGianHienTai
              
              $gioConLai = [math]::Max(0, [math]::Floor($thoiGianConLai.TotalHours))
              $phutConLai = [math]::Max(0, [math]::Floor($thoiGianConLai.TotalMinutes % 60))
              $giayConLai = [math]::Max(0, [math]::Floor($thoiGianConLai.TotalSeconds % 60))
              
              $frame = $frames[([int]((Get-Date) - $startTime).TotalSeconds) % $frames.Length]
              $color = $colors[([int]((Get-Date) - $startTime).TotalMinutes) % $colors.Length]
              
              Write-Host "`r$frame [$($thoiGianHienTai.ToString('HH:mm:ss'))] Time remaining: $gioConLai hours $phutConLai minutes $giayConLai seconds" -NoNewline -ForegroundColor $color
              
              Start-Sleep -Seconds 5
              
          } while ($thoiGianConLai.TotalSeconds -gt 0)

          Write-Host ""
          Write-Host "üéØ TIME'S UP - STOPPING AUTOMATICALLY!" -ForegroundColor Red

          Get-Job -Name "SystemMonitor" -ErrorAction SilentlyContinue | Stop-Job -PassThru | Remove-Job -Force

      # CLEANUP
      - name: üßπ SYSTEM CLEANUP
        if: always()
        run: |
          Write-Host ""
          Write-Host "üßπ CLEANING UP SYSTEM..." -ForegroundColor Yellow

          $cleanupSteps = @(
              @{Name="Delete password file"; Script={
                  Remove-Item "$env:TEMP\rdp_password.txt" -ErrorAction SilentlyContinue
              }},
              @{Name="Disable user"; Script={
                  Disable-LocalUser -Name "AISTV-PREMIUM" -ErrorAction SilentlyContinue
              }},
              @{Name="Close network connection"; Script={
                  if ($env:TAILSCALE_INSTALLED -eq "true") {
                      tailscale down --accept-risk=all -ErrorAction SilentlyContinue
                      Start-Sleep -Seconds 5
                  }
              }},
              @{Name="Delete firewall rule"; Script={
                  netsh advfirewall firewall delete rule name="RDP-Premium" dir=in -ErrorAction SilentlyContinue
                  netsh advfirewall firewall delete rule name="RDP-Premium-Out" dir=out -ErrorAction SilentlyContinue
                  Remove-NetFirewallRule -DisplayName "RDP-Premium" -ErrorAction SilentlyContinue
                  Remove-NetFirewallRule -DisplayName "RDP-Premium-Out" -ErrorAction SilentlyContinue
              }},
              @{Name="Restore RDP settings"; Script={
                  Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -Name "fDenyTSConnections" -Value 1 -Force -ErrorAction SilentlyContinue
                  Stop-Service -Name TermService -Force -ErrorAction SilentlyContinue
              }}
          )

          foreach($step in $cleanupSteps) {
              Write-Host "‚îÇ üóëÔ∏è  $($step.Name)..." -NoNewline -ForegroundColor Gray
              try {
                  & $step.Script
                  Write-Host "`r‚îÇ ‚úÖ $($step.Name)" -ForegroundColor Green
              } catch {
                  Write-Host "`r‚îÇ ‚ö†Ô∏è  $($step.Name) - Safely handled" -ForegroundColor Yellow
              }
              Start-Sleep -Milliseconds 300
          }

          Get-Job | Stop-Job -PassThru | Remove-Job -Force -ErrorAction SilentlyContinue

          Write-Host ""
          Write-Host "üéâ Cleanup complete! See you again! üëã" -ForegroundColor Green
